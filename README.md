# ANSE_forecaster
The purpose of this project is to provide a forecasting framework for network path throughput.

This code is used to obtain perfSONAR data, analyze the data, and generate forecasts of the data based on specified forecasting models, data groupings, and other criteria. It can handle multiple forecasting models simultaneously.

Outside of obtaining data from perfSONAR, this code works as a complete, stand-alone, system. The only configuration required is to specify the value of FORECASTER_HOME in env.sh and create a local mySQL database.


#### General steps
1. Specify the root directory of this application as the value of FORECASTER_HOME in env.sh.  
   E.g., FORECASTER_HOME=/root/madness  
2. Build a local database to store perfSONAR raw data, generated forecasts, and related data.  
   - Build a sample database, called madCow:  
  ```
    cd $FORECASTER_HOME/bin  
    ./env.sh ./registry --create_registry madCow  
  ```
   - Create an archive for perfSONAR throughput (bandwidth) data  
  ```
    ./env.sh ./registry --use madCow --add_archive throughput  
  ```
   - Create data grouping tables. These specify how the data are to be grouped to generate forecasts  
     E.g., byTime arranges data chronologically.  
     byHour groups into the nth hour time slot all measurement data from any date which occurred between  
     n:00 and n:59, 0<=n<=23.  
  ```
     ./env.sh ./registry --use madCow --add_group byTime --clause 0 --time_block 0  
     ./env.sh ./registry --use madCow --add_group byHour --clause "HOUR(FROM_UNIXTIME(time))" --time_block 2  
  ```
   - Create forecast tables for desired forecasts, specified by the given forecast model, archive, and grouping.  
  ```
     ./env.sh ./registry --use madCow --add_model ets --use_archive throughput --use_group byTime --Enabled --ranking 4  
     ./env.sh ./registry --use madCow --add_model ets --use_archive throughput --use_group byHour --Enabled --ranking 2  
  ```
3. Generate forecasts  
   Forecasts are normally generated by cron jobs. See sample cron under $FORECASTER_HOME/conf/smokeit.cron.  
   The sequence can be executed manually as:  
  ```
     ./env.sh $FORECASTER_HOME/bin/smoke --db madCow --archive throughput --base 10 --cycles 4 --cols 2 --catchuponly  
  ```

   Or, to do each step in the script above manually:  
   - Obtain the raw perfSONAR data.  
  ```
     ./env.sh $FORECASTER_HOME/bin/get_staging_files  
  ```
   - Insert the raw data into the database  
  ```
     ./env.sh $FORECASTER_HOME/bin/load_staging_files --archive throughput  
  ```
   - Insert into the database new nodes encountered, if any  
  ```
     ./env.sh $FORECASTER_HOME/bin/insert_nodes --archive throughput  
  ```
   - Insert missing node names, if any  
  ```
     ./env.sh $FORECASTER_HOME/bin/insert_node_names  
  ```
   - Processed the raw data and insert them into the archive tables  
  ```
     ./env.sh $FORECASTER_HOME/bin/update_archive_table --archive throughput  
  ```
   - Generate the forecasts  
  ```
     ./env.sh $FORECASTER_HOME/bin/gen_forecasts --db madCow --cycles 4 --cols 2 --base 10 --catchup  
  ```
